sap.ui.define(["dteconsentappclient/controller/BaseController","sap/ui/core/Fragment","sap/ui/model/json/JSONModel"],(e,t,o)=>{"use strict";return e.extend("dteconsentappclient.controller.Landlord",{onInit(){let e={SignatureSignedBy:"",SignatureSignedDate:"",AccountDetail:{}};const t=new o(e);this.getView().setModel(t,"oEnrollModel");const n=new sap.ui.model.json.JSONModel({locations:[]});this.getView().setModel(n,"locationModel");this.onAddAnotherLocation();const i=new sap.ui.model.json.JSONModel({dqmAddress:[]});this.getView().setModel(i,"dqmAddressModel");const{url:s,headers:l}=this.getApiConfig();this.HEADERS=l;this.SERVERHOST=s},onRadioButtonSelect:function(e){let t=e.getSource().getSelectedButton().getText();let o=false;console.log(t);if(t==="Yes")o=true;else o;let n=this.getView().getModel("oEnrollModel");n.setProperty("/AccountDetail/EnergyPrgmParticipated",o)},handleSubmit:async function(){const e=this.getView().getModel("oEnrollModel").getData();console.log(e);let t=this.getView().getModel("locationModel").getData();console.log(JSON.stringify(t));const o={SignatureSignedBy:e.SignatureSignedBy,SignatureSignedDate:e.SignatureSignedDate,AccountDetail:JSON.stringify(e.AccountDetail),BuildingDetail:JSON.stringify(t.locations)};console.log("Payload to send:",o.AccountDetail);try{const e=await axios.post(`${this.SERVERHOST}service/CreateEnrollmentFormDetail`,o);console.log(e)}catch(e){console.error("Error:",e);MessageBox.error("An error occurred while submitting the form. Please try again later.")}},onAddAnotherLocation:function(){const e=this.getView();const o=e.getModel("locationModel");const n=this.byId("building_detail_main_container");const i=o.getProperty("/locations");i.push({buildingName:"",accountNumber:"",locationAddress:"",city:"",state:"",zipcode:""});o.setProperty("/locations",i);const s=i.length-1;t.load({name:"dteconsentappclient.fragment.Buildingdetail",controller:this}).then(function(e){e.setModel(o,"locationMoel");e.bindElement(`locationModel>/locations/${s}`);n.addItem(e)}).catch(function(e){console.log(`Failed to load fragment:, ${e}`)})},onbuildingLocationAddressChange:async function(e){const t=this.getView();const o=t.getModel("dqmAddressModel");const n=t.getModel("locationModel");const i=e.getParameter("value");const s="FHSdLToNjfzJbP0DyZrAuSadyk3cv3433c5uggPL80yV60ZxQ1NCJQQJ99ALACYeBjFqbPoVAAAgAZMP4eHm&typeahead=true";const l=await axios.get("https://test.api.customer.sites.dteenergy.com/public/qa/premises/?address=8550%20HAGG&maxResults=50");const c=l.data.results;o.setProperty("/dqmAddress",c)},onsuggestionItemSelected:function(e){const t=this.getView();const o=t.getModel("locationModel");console.log(o);const n=e.getParameter("selectedItem");if(n){const t=n.getText();console.log(t);const i=t.split(",");if(i.length>4){const n=i[4].trim();const s=i[5].trim();const l=i[6].trim();const c=e.getSource().getBindingContext("locationModel").getPath().split("/")[2];console.log(c,"Index");const a=o.getProperty("/locations");if(a[c]){a[c].city=n;a[c].state=s;a[c].zipcode=l;a[c].locationAddress=t;o.setProperty("/locations",a)}}}},onRemoveTrigger:function(e){const t=e.getSource();const o=t.getParent();const n=this.byId("building_detail_main_container");n.removeItem(o);o.destroy()},onSubmit:function(){const e=this.getView();const t=e.getModel("locationModel");const o=t.getProperty("/locations");console.log(o)}})});
//# sourceMappingURL=Landlord.controller.js.map
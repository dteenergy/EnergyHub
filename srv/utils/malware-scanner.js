/**
 * This module contains SAP Malware Scanning Service
 * @link https://api.sap.com/api/MalwareScanAPI/cloud-sdk/JavaScript
 */

const {DefaultApi} = require('../external/service/MalwareScanAPI');

const scanfile = async (file) =>{
    try {
        const responseData = await DefaultApi.createScan(file)
            .addCustomHeaders({ 'Content-Type': 'application/octet-stream' })
            .addCustomHeaders({ 'Accept': 'application/json' })
            .execute({ destinationName: 'dteConsentAppPortal-malwarescanner-dest' });
            
        console.log(responseData);
        return responseData;
    } catch (error) {
        console.log(error);
        throw error
    }
}

module.exports = {
    scanfile
}